(this["webpackJsonpreact-social-site"]=this["webpackJsonpreact-social-site"]||[]).push([[0],{58:function(e,t,n){},79:function(e,t,n){"use strict";n.r(t);var r=n(1),s=n.n(r),o=n(33),c=n.n(o),a=(n(58),n(3)),i=n(4),u=n(6),l=n(5),d=n(2),h=n(7),p=n(31),j="UPDATE_POSTS",m="LOGIN_START",f="LOGIN_SUCCESS",b="LOGIN_FAILED",v="SIGNUP_START",O="SIGNUP_SUCCESS",g="SIGNUP_FAILED",x="AUTHENTICATE_USER",S="LOG_OUT",N="CLEAR_AUTH_STATE",y="EDIT_PROFILE_SUCCESS",k="EDIT_PROFILE_FAILED",E="USER_PROFILE_SUCCESS",C="USER_PROFILE_FAILED",_="USER_PROFILE_BEGIN",I="CLEAR_PROFILE_STATE",T="FETCH_USER_FRIENDS_SUCCESS",P="FETCH_USER_FRIENDS_FAILED",F="FETCH_USER_FRIENDS_BEGIN",L="ADD_FRIEND_FAILED",w="ADD_FRIEND_SUCESS",R="ADD_FRIEND_BEGIN",U="REMOVE_FRIEND_FAILED",A="REMOVE_FRIEND_SUCESS",D="REMOVE_FRIEND_BEGIN",B="CLEAR_FRIEND_STATE",G="ADD_POST_SUCCESS",z="ADD_POST_FAILED",M="ADD_COMMENT_SUCCESS",V="ADD_COMMENT_FAILED",H="TOGGLE_LIKE_SUCCESS",W="TOGGLE_LIKE_FAILED",J="FETCH_SEARCH_USERS",q="CLEAR_SEARCH",K="FETCH_CONVERSATION_SUCCESS",Q="FETCH_CONVERSATION_START",X="FETCH_CONVERSATION_FAILED",Y="ADD_MESSAGE",Z={posts:[],next:null,prev:null,error:null};var $="https://powerful-hamlet-85569.herokuapp.com/api",ee={fetchposts:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5;return $+"/posts?page=".concat(e,"&limit=").concat(t)},login:function(){return $+"/users/login"},signup:function(){return $+"/users/signup"},editProfile:function(){return $+"/users/edit"},fetchProfile:function(e){return $+"/users/".concat(e)},fetchFriends:function(){return $+"/friendship/fetch_user_friends"},AddFriend:function(e){return $+"/friendship/create_friendship?user_id=".concat(e)},RemoveFriend:function(e){return $+"/friendship/remove_friendship?user_id=".concat(e)},createPost:function(){return $+"/posts/create"},createComment:function(){return $+"/comments"},toggleLike:function(e,t){return $+"/likes/toggle?id=".concat(e,"&type=").concat(t)},SearchUsers:function(e){return $+"/users/search?text=".concat(e)},UploadPic:function(){return $+"/users/editPhoto/"},SERVER_URL:function(){return"https://powerful-hamlet-85569.herokuapp.com"},get_conversation:function(e){return $+"/conversation/".concat(e)}},te=ee,ne=te.login();function re(e){return console.log(e),function(t){t({type:m}),fetch(ne,{method:"POST",body:JSON.stringify({email:e.email,password:e.password}),headers:{"Content-type":"application/json; charset=UTF-8"}}).then((function(e){return e.json()})).then((function(e){console.log(e),e.success?(localStorage.setItem("token",e.data.token),setTimeout((function(){var n;t((n=e.data.user,{type:f,user:n}))}),1e3)):setTimeout((function(){var n;t((n=e.error,{type:b,error:n}))}),1e3)})).catch((function(e){return console.log("error",e)}))}}function se(){return{type:S}}function oe(){return{type:N}}function ce(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=te.fetchposts(e);return function(e){fetch(t).then((function(e){return e.json()})).then((function(t){var n=t.next,r=t.prev;"undefined"==typeof n&&(n=null),"undefined"==typeof r&&(r=null),e(ae(t.data.posts,n,r))})).catch((function(e){return console.log("error",e)}))}}function ae(e,t,n){return{type:j,posts:e,next:t,prev:n}}function ie(e){var t=te.createPost();return function(n){var r=localStorage.getItem("token");fetch(t,{method:"POST",body:JSON.stringify({content:e}),headers:{"Content-type":"application/json; charset=UTF-8",Authorization:"Bearer ".concat(r)}}).then((function(e){return"401"==e.status&&n(se()),e.json()})).then((function(e){e.success?setTimeout((function(){var t;n((t=e.data.post,{type:G,post:t}))}),500):setTimeout((function(){var t;n((t=e.error,{type:z,error:t}))}),500)})).catch((function(e){return console.log("error",e)}))}}var ue=n(8),le=n(11);function de(e,t){var n=te.createComment();return function(r){var s=localStorage.getItem("token");fetch(n,{method:"POST",body:JSON.stringify({content:e,post_id:t}),headers:{"Content-type":"application/json; charset=UTF-8",Authorization:"Bearer ".concat(s)}}).then((function(e){return"401"==e.status&&r(se()),e.json()})).then((function(e){console.log(e),e.success?setTimeout((function(){r(function(e,t){return{type:M,comment:e,post_id:t}}(e.comment,t))}),500):setTimeout((function(){var t;r((t=e.error,{type:V,error:t}))}),500)})).catch((function(e){return console.log("error",e)}))}}function he(e,t){var n=te.toggleLike(e,t);return function(r){var s=localStorage.getItem("token");fetch(n,{method:"POST",headers:{"Content-type":"application/json; charset=UTF-8",Authorization:"Bearer ".concat(s)}}).then((function(e){return e.json()})).then((function(n){console.log(n),n.success?setTimeout((function(){r(function(e,t,n,r){return{type:H,deleted:e,id:t,likeabletype:n,like:r}}(n.data.deleted,e,t,n.data.liketosent))}),50):setTimeout((function(){var e;r((e=n.error,{type:W,error:e}))}),50)})).catch((function(e){return console.log("error",e)}))}}var pe=n(0),je=function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(){var e;Object(a.a)(this,n);for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return(e=t.call.apply(t,[this].concat(s))).handleToggleLike=function(){var t=e.props.comment;e.props.dispatch(he(t._id,"Comment"))},e.isLikedByUser=function(){var t,n=e.props.comment,r=e.props.auth.user;for(t=0;t<n.likes.length;t++)if(n.likes[t].user==r._id)return!0;return!1},e}return Object(i.a)(n,[{key:"render",value:function(){var e=this.isLikedByUser();console.log(e);var t=this.props.comment;return Object(pe.jsxs)("div",{className:"comment",children:[Object(pe.jsxs)("div",{className:"name-time",children:[t.user.name," a minute ago"]}),Object(pe.jsx)("div",{className:"comment-content",children:t.content}),Object(pe.jsxs)("div",{className:"comment-likes-count",children:[Object(pe.jsx)("img",{onClick:this.handleToggleLike,src:e?"https://cdn-icons-png.flaticon.com/512/633/633991.png":"https://cdn-icons-png.flaticon.com/512/633/633759.png"}),t.likes.length]})]})}}]),n}(r.Component);var me=Object(h.b)((function(e){return{auth:e.auth,posts:e.posts}}))(je),fe=function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(e){var r;return Object(a.a)(this,n),(r=t.call(this)).handleChange=function(e){var t=e.target.value;r.setState({content:t})},r.handleAddcomment=function(e){var t=r.props.post;""!==r.state.content&&"Enter"==e.key&&(r.props.dispatch(de(r.state.content,t._id)),r.setState({content:""}))},r.handleToggleLike=function(){var e=r.props.post;r.props.dispatch(he(e._id,"Post"))},r.isLikedByUser=function(){var e,t=r.props.post,n=r.props.auth.user;for(e=0;e<t.likes.length;e++)if(t.likes[e].user==n._id)return!0;return!1},r.state={content:""},r}return Object(i.a)(n,[{key:"render",value:function(){var e=this.props.post,t=this.isLikedByUser(),n=te.SERVER_URL()+e.user.avatar;return console.log("LIKED",t),Object(pe.jsxs)("div",{className:"Post",children:[Object(pe.jsxs)("div",{className:"user-info",children:[Object(pe.jsx)(le.b,{to:"/user/".concat(e.user._id),children:Object(pe.jsx)("img",{src:e.user.avatar?n:"https://cdn-icons-png.flaticon.com/512/2922/2922506.png",className:"post-icon"})}),Object(pe.jsxs)("div",{className:"post-user-name",children:[e.user.name,Object(pe.jsx)("div",{className:"time",children:"a minute ago"})]})]}),Object(pe.jsx)("p",{className:"post-content",children:e.content}),Object(pe.jsxs)("div",{className:"likes-comment-icon",children:[Object(pe.jsx)("img",{onClick:this.handleToggleLike,src:t?"https://cdn-icons-png.flaticon.com/512/1076/1076984.png":"https://cdn-icons-png.flaticon.com/512/1077/1077035.png"}),Object(pe.jsx)("div",{className:"likes-count",children:e.likes.length}),Object(pe.jsx)("img",{src:"https://cdn-icons-png.flaticon.com/512/1380/1380338.png"}),Object(pe.jsx)("div",{className:"comments-count",children:e.comment.length})]}),Object(pe.jsxs)("div",{className:"comments",children:[Object(pe.jsx)("input",{onChange:this.handleChange,onKeyPress:this.handleAddcomment,onk:!0,className:"comments-form",placeholder:"Type your comment here"}),e.comment.map((function(e){return Object(pe.jsx)(me,{comment:e},e._id)}))]})]})}}]),n}(r.Component);var be=Object(h.b)((function(e){return{auth:e.auth,posts:e.posts}}))(fe),ve=function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(e){var r;return Object(a.a)(this,n),(r=t.call(this,e)).handleChange=function(e){r.setState({post_content:e.target.value})},r.handleSubmit=function(){var e=r.state.post_content;0!=e.length&&r.props.dispatch(ie(e))},r.state={post_content:"",post_file:null},r}return Object(i.a)(n,[{key:"render",value:function(){var e=this,t=this.props.posts.error;return Object(pe.jsxs)("div",{className:"post-form-container",children:[0==t&&Object(pe.jsx)("div",{className:"success-dialog",children:"Post Created Successfully"}),t&&Object(pe.jsx)("div",{className:"alert-dialog",children:t}),Object(pe.jsx)("div",{className:"post-input-container",children:Object(pe.jsx)("textarea",{onChange:function(t){return e.handleChange(t)},placeholder:"What's in your mind?"})}),Object(pe.jsx)("div",{className:"post-btn-container",children:Object(pe.jsx)("div",{onClick:this.handleSubmit,className:"post-btn",children:"Add Post"})})]})}}]),n}(r.Component);var Oe=Object(h.b)((function(e){return{posts:e.posts}}))(ve),ge=n(26),xe=function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(){return Object(a.a)(this,n),t.apply(this,arguments)}return Object(i.a)(n,[{key:"componentDidMount",value:function(){this.props.dispatch(ce())}},{key:"render",value:function(){var e=this.props.posts,t=e.posts,n=(e.error,this.props.auth.isLoggedIn);return 0==t.length?Object(pe.jsx)(ge.BookLoader,{text:"Fetching Posts...",background:"linear-gradient(135deg, #6066FA, #4645F6)",desktopSize:"50px",mobileSize:"50px",textColor:"#4645F6"}):Object(pe.jsxs)("div",{className:"post-list1",children:[n&&Object(pe.jsx)(Oe,{}),Object(pe.jsx)("div",{className:n?"Post-list":"Post-listN",children:t.map((function(e){return Object(pe.jsx)(be,{post:e},e._id)}))})]})}}]),n}(r.Component);var Se=Object(h.b)((function(e){return{auth:e.auth,posts:e.posts}}))(xe),Ne=function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(){return Object(a.a)(this,n),t.apply(this,arguments)}return Object(i.a)(n,[{key:"render",value:function(){var e=this.props.result;console.log("RESULT",e);var t=te.SERVER_URL()+e.avatar;return Object(pe.jsx)(le.b,{to:"/user/".concat(e._id),children:Object(pe.jsxs)("div",{className:"result",children:[Object(pe.jsx)("img",{src:e.avatar?t:"https://cdn-icons-png.flaticon.com/512/2922/2922506.png"}),Object(pe.jsx)("div",{children:e.name})]})})}}]),n}(r.Component),ye=Ne;function ke(e){var t=te.SearchUsers(e);return function(e){var n=localStorage.getItem("token");fetch(t,{method:"GET",headers:{"Content-type":"application/json; charset=UTF-8",Authorization:"Bearer ".concat(n)}}).then((function(t){return"401"==t.status&&e(se()),t.json()})).then((function(t){var n;e((n=t.data.users,{type:J,results:n}))})).catch((function(e){return console.log("error",e)}))}}var Ee=function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(e){var r;return Object(a.a)(this,n),(r=t.call(this,e)).handleChange=function(e){var t=e.target.value;""!==t?r.props.dispatch(ke(t)):r.props.dispatch({type:q})},r.handleInputFocus=function(){r.setState({focus:!0})},r.handleInputBlur=function(e){var t=document.getElementsByClassName("search");if(0!=t.length){var n=t[0].contains(e.target);console.log(n),n||r.setState({focus:!1})}},r.state={focus:!1},r}return Object(i.a)(n,[{key:"componentDidMount",value:function(){var e=this;window.addEventListener("click",(function(t){e.handleInputBlur(t)}))}},{key:"componentWillUnmount",value:function(){var e=this;window.removeEventListener("click",(function(t){e.handleInputBlur(t)}))}},{key:"render",value:function(){var e=this,t=this.props.search.results;console.log("RESULTS",t);var n=this.state.focus;return Object(pe.jsxs)("div",{className:"search",onFocus:this.handleInputFocus,children:[Object(pe.jsx)("input",{onChange:this.handleChange,placeholder:"Search name"}),0!=t.length&&0!=n&&Object(pe.jsx)("div",{className:"search-results",children:t.map((function(t){return Object(pe.jsx)(ye,{onFocus:e.handleInputFocus,result:t},t._id)}))})]})}}]),n}(r.Component);var Ce=Object(h.b)((function(e){return{auth:e.auth,search:e.search}}))(Ee),_e=function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(){var e;Object(a.a)(this,n);for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return(e=t.call.apply(t,[this].concat(s))).logOut=function(){localStorage.removeItem("token"),e.props.dispatch(se())},e}return Object(i.a)(n,[{key:"render",value:function(){var e=this.props.auth,t=e.isLoggedIn,n=e.user,r=window.location.href;console.log(r);var s=te.SERVER_URL()+n.avatar;return Object(pe.jsxs)("div",{className:"navbar",children:[Object(pe.jsxs)("div",{className:"nav-left-container",children:[Object(pe.jsx)(le.b,{to:"/",children:Object(pe.jsx)("img",{src:"https://cdn-icons-png.flaticon.com/512/2111/2111421.png",className:"logo"})}),Object(pe.jsx)("div",{className:"site-name",children:"Socializer"})]}),Object(pe.jsx)("div",{className:"nav-middle-container",children:Object(pe.jsx)(Ce,{})}),Object(pe.jsxs)("div",{className:"nav-right-container",children:[t&&Object(pe.jsxs)("div",{className:"user-nav",children:[Object(pe.jsx)(le.b,{to:"/settings",children:Object(pe.jsx)("img",{src:n.avatar?s:"https://cdn-icons-png.flaticon.com/512/2922/2922506.png",className:"user-logo"})}),Object(pe.jsx)("div",{className:"username-nav",children:n.name})]}),0==t&&Object(pe.jsx)(le.b,{className:"nav-btn",to:"/login",children:Object(pe.jsx)("div",{children:"LogIn"})}),t&&Object(pe.jsx)("button",{onClick:this.logOut,className:"logout-btn",children:"LogOut"}),0==t&&Object(pe.jsx)(le.b,{className:"nav-btn",to:"/Register",children:Object(pe.jsx)("div",{children:"Register"})})]})]})}}]),n}(r.Component);var Ie=Object(h.b)((function(e){return{auth:e.auth}}))(_e),Te=n(23);function Pe(){return function(e){var t=te.fetchFriends(),n=localStorage.getItem("token");e({type:F}),fetch(t,{method:"GET",headers:{"Content-type":"application/json; charset=UTF-8",Authorization:"Bearer ".concat(n)}}).then((function(t){return"401"==t.status&&e(se()),t.json()})).then((function(t){console.log("Data",t),t.success?setTimeout((function(){var n;e((n=t.data.friendships,{type:T,friendships:n}))}),500):setTimeout((function(){var n;e((n=t.error,{type:P,error:n}))}),500)})).catch((function(e){return console.log("error",e)}))}}function Fe(e){return function(t){var n=te.AddFriend(e),r=localStorage.getItem("token");t({type:R}),fetch(n,{method:"POST",headers:{"Content-type":"application/json; charset=UTF-8",Authorization:"Bearer ".concat(r)}}).then((function(e){return"401"==e.status&&t(se()),e.json()})).then((function(e){console.log("Data",e),e.success?setTimeout((function(){var n;t((n=e.data.friendship,{type:w,friendship:n}))}),500):setTimeout((function(){var n;t((n=e.error,{type:L,error:n}))}),500)})).catch((function(e){return console.log("error",e)}))}}function Le(){return{type:B}}function we(e){return function(t){var n=te.RemoveFriend(e),r=localStorage.getItem("token");t({type:D}),fetch(n,{method:"POST",headers:{"Content-type":"application/json; charset=UTF-8",Authorization:"Bearer ".concat(r)}}).then((function(e){return"401"==e.status&&t(se()),e.json()})).then((function(e){console.log("Data",e),e.success?setTimeout((function(){t(function(e){return{type:A,id:e}}(e.removed_id))}),500):setTimeout((function(){var n;t((n=e.error,{type:U,error:n}))}),500)})).catch((function(e){return console.log("error",e)}))}}var Re=function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(){return Object(a.a)(this,n),t.apply(this,arguments)}return Object(i.a)(n,[{key:"render",value:function(){var e=this.props.friend,t=this.props.fid,n=te.SERVER_URL()+e.avatar;return Object(pe.jsxs)("div",{className:"friend",children:[Object(pe.jsx)("div",{className:"friend-icon",children:Object(pe.jsx)(le.b,{to:"/user/".concat(e._id),children:Object(pe.jsx)("img",{src:e.avatar?n:"https://cdn-icons-png.flaticon.com/512/2922/2922506.png"})})}),Object(pe.jsx)("div",{className:"friend-name",children:Object(pe.jsx)("div",{children:e.name})}),Object(pe.jsx)(le.b,{to:"/chat/".concat(t),children:Object(pe.jsx)("button",{className:"chat-btn",children:"Chat"})})]})}}]),n}(r.Component),Ue=Re,Ae=function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(e){return Object(a.a)(this,n),t.call(this,e)}return Object(i.a)(n,[{key:"componentWillUnmount",value:function(){this.props.dispatch(Le())}},{key:"componentDidMount",value:function(){this.props.dispatch(Pe())}},{key:"render",value:function(){var e,t=this.props.friends,n=t.friendships,r=t.inProgress,s=t.error,o=this.props.auth.user;return r?Object(pe.jsx)(ge.WifiLoader,(e={className:"loader",background:"transparent",backColor:"rgb(66, 110, 240)",desktopSize:"90px",mobileSize:"90px",text:"Fetching Friends..."},Object(Te.a)(e,"backColor","rgb(66, 110, 240)"),Object(Te.a)(e,"frontColor","#4645F6"),e)):s?Object(pe.jsx)("h1",{children:s}):Object(pe.jsxs)("div",{className:"friends-container",children:[Object(pe.jsx)("div",{className:"friends-heading",children:"Friends"}),n.map((function(e){var t=e.from_user;return t._id==o._id&&(t=e.to_user),Object(pe.jsx)(Ue,{friend:t,fid:e._id})}))]})}}]),n}(r.Component);var De=Object(h.b)((function(e){return{auth:e.auth,friends:e.friends}}))(Ae),Be=function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(){var e;Object(a.a)(this,n);for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return(e=t.call.apply(t,[this].concat(s))).handlenextclick=function(){var t=e.props.posts.next;e.props.dispatch(ce(t.page))},e.handleprevclick=function(){var t=e.props.posts.prev;e.props.dispatch(ce(t.page))},e}return Object(i.a)(n,[{key:"render",value:function(){this.props.posts.posts;var e=this.props.posts,t=e.next,n=e.prev;return Object(pe.jsxs)("div",{className:"Footer-container",children:[Object(pe.jsxs)("div",{className:"footer-btns",children:[Object(pe.jsx)("button",{onClick:this.handleprevclick,className:n?"fbtn":"fbtn hidebtn",children:"<"}),Object(pe.jsx)("button",{onClick:this.handlenextclick,className:t?"fbtn":"fbtn hidebtn",children:">"})]}),Object(pe.jsx)("div",{className:"footer",children:"\xa9 2021 Apoorv Jain"})]})}}]),n}(r.Component);var Ge=Object(h.b)((function(e){return{posts:e.posts}}))(Be),ze=function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(){return Object(a.a)(this,n),t.apply(this,arguments)}return Object(i.a)(n,[{key:"render",value:function(){var e=this.props.auth.isLoggedIn;return console.log("props",this.props),Object(pe.jsxs)("div",{className:"home",children:[Object(pe.jsx)(Se,{}),e&&Object(pe.jsx)(De,{})]})}}]),n}(r.Component);var Me=Object(h.b)((function(e){return{auth:e.auth}}))(ze);var Ve=function(e){return Object(pe.jsx)("div",{children:Object(pe.jsx)("h1",{children:"404: Page not found"})})},He=function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(e){var r;return Object(a.a)(this,n),(r=t.call(this,e)).handleEmailInput=function(e){var t=e.target.value;r.setState({email:t})},r.handlePasswordInput=function(e){var t=e.target.value;r.setState({password:t})},r.handleSubmit=function(e){e.preventDefault(),console.log(r.state),r.props.dispatch(re(r.state))},r.state={email:"",password:""},r}return Object(i.a)(n,[{key:"componentWillUnmount",value:function(){this.props.dispatch(oe())}},{key:"render",value:function(){var e=this.props.auth,t=e.error,n=e.inProgress,r=e.user,s=e.isLoggedIn,o=(this.props.location.state||{from:{pathname:"/"}}).from;return s?Object(pe.jsx)(ue.a,{to:o}):(console.log(this.props.auth),Object(pe.jsxs)("div",{className:"login-container",children:[Object(pe.jsx)("div",{className:"login-heading",children:"Login"}),t&&Object(pe.jsx)("div",{className:"alert-dialog",children:t}),s&&Object(pe.jsx)("div",{className:"success-dialog",children:"Successfully signed in as ".concat(r.name)}),Object(pe.jsxs)("form",{className:"login-form",children:[Object(pe.jsx)("input",{type:"email",required:!0,placeholder:"Enter your email",onChange:this.handleEmailInput}),Object(pe.jsx)("input",{type:"password",required:!0,placeholder:"Enter your password",onChange:this.handlePasswordInput}),n?Object(pe.jsx)("button",{type:"submit",className:"submit-btn",onClick:this.handleSubmit,disabled:n,children:"Logging In"}):Object(pe.jsx)("button",{type:"submit",className:"submit-btn",onClick:this.handleSubmit,children:"Log In"})]})]}))}}]),n}(r.Component);var We=Object(h.b)((function(e){return{auth:e.auth}}))(He),Je=te.signup();function qe(e){return console.log(e),function(t){t({type:v}),fetch(Je,{method:"POST",body:JSON.stringify({email:e.email,password:e.password,confirmpassword:e.confirmpassword,name:e.name}),headers:{"Content-type":"application/json; charset=UTF-8"}}).then((function(e){return e.json()})).then((function(e){console.log(e),e.success?setTimeout((function(){var n;localStorage.setItem("token",e.data.token),t((n=e.data.user,{type:O,user:n}))}),1e3):setTimeout((function(){var n;t((n=e.error,{type:g,error:n}))}),1e3)})).catch((function(e){return console.log("error",e)}))}}var Ke=function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(e){var r;return Object(a.a)(this,n),(r=t.call(this,e)).handleEmailInput=function(e){var t=e.target.value;r.setState({email:t})},r.handleConfirmPasswordInput=function(e){var t=e.target.value;r.setState({confirmpassword:t})},r.handleNameInput=function(e){var t=e.target.value;r.setState({name:t})},r.handlePasswordInput=function(e){var t=e.target.value;r.setState({password:t})},r.handleSubmit=function(e){e.preventDefault(),console.log(r.state),r.props.dispatch(qe(r.state))},r.state={email:"",password:"",confirmpassword:"",name:""},r}return Object(i.a)(n,[{key:"componentWillUnmount",value:function(){this.props.dispatch(oe())}},{key:"render",value:function(){var e=this.props.auth,t=e.error,n=e.inProgress,r=e.user,s=e.isLoggedIn;return s?Object(pe.jsx)(ue.a,{to:"/"}):(console.log(this.props.auth),Object(pe.jsxs)("div",{className:"login-container",children:[Object(pe.jsx)("div",{className:"login-heading",children:"SignUp"}),t&&Object(pe.jsx)("div",{className:"alert-dialog",children:t}),s&&Object(pe.jsx)("div",{className:"success-dialog",children:"Successfully signed in as ".concat(r.user.name)}),Object(pe.jsxs)("form",{className:"login-form",children:[Object(pe.jsx)("input",{type:"text",required:!0,placeholder:"Enter your name",onChange:this.handleNameInput}),Object(pe.jsx)("input",{type:"email",required:!0,placeholder:"Enter your email",onChange:this.handleEmailInput}),Object(pe.jsx)("input",{type:"password",required:!0,placeholder:"Enter your password",onChange:this.handlePasswordInput}),Object(pe.jsx)("input",{type:"password",required:!0,placeholder:"Enter password again",onChange:this.handleConfirmPasswordInput}),n?Object(pe.jsx)("button",{type:"submit",className:"submit-btn",onClick:this.handleSubmit,disabled:n,children:"Signing Up"}):Object(pe.jsx)("button",{type:"submit",className:"submit-btn",onClick:this.handleSubmit,children:"Sign Up"})]})]}))}}]),n}(r.Component);var Qe=Object(h.b)((function(e){return{auth:e.auth}}))(Ke),Xe=n(46);te.UploadPic();function Ye(e){return{type:y,user:e}}function Ze(e){return{type:k,error:e}}var $e=function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(e){var r;return Object(a.a)(this,n),(r=t.call(this,e)).handleUpload=function(){var e=r.props.auth.user;r.state.selectedFile&&r.props.dispatch(function(e,t){var n=te.UploadPic();return console.log(n),console.log(t),console.log(e),function(e){var r=localStorage.getItem("token"),s=new FormData;s.append("avatar",t),fetch(n,{method:"POST",body:s,headers:{Authorization:"Bearer ".concat(r)}}).then((function(t){return"401"==t.status&&e(se()),t.json()})).then((function(t){console.log(t),t.success?(localStorage.setItem("token",t.data.token),setTimeout((function(){e(Ye(t.data.user))}),500)):setTimeout((function(){e(Ze(t.error))}),500)})).catch((function(e){return console.log("error",e)}))}}(e._id,r.state.selectedFile))},r.handleFile=function(e){console.log(e.target.files[0]),r.setState({selectedFile:e.target.files[0]})},r.handleChange=function(e,t){r.setState(Object(Te.a)({},t,e))},r.handleEdit=function(){r.setState({editmode:!0})},r.handleBack=function(){r.setState({editmode:!1})},r.fun=function(){0==r.props.auth.error&&r.setState({editmode:!1})},r.handleSave=function(){var e=r.state,t=e.name,n=e.password,s=e.confirmpassword;if(0==t.length||0==n.length||s!=n)r.props.dispatch(Ze("Invalid Input"));else{var o=r.props.auth.user._id;console.log("Success",o),r.props.dispatch(function(e,t,n,r){console.log(r);var s=te.editProfile();return function(o){var c=localStorage.getItem("token");fetch(s,{method:"POST",body:JSON.stringify({name:e,password:t,confirmpassword:n,id:""+r}),headers:{"Content-type":"application/json; charset=UTF-8",Authorization:"Bearer ".concat(c)}}).then((function(e){return"401"==e.status&&o(se()),e.json()})).then((function(e){console.log(e),e.success?(localStorage.setItem("token",e.data.token),setTimeout((function(){o(Ye(e.data.user))}),500)):setTimeout((function(){o(Ze(e.error))}),500)})).catch((function(e){return console.log("error",e)}))}}(t,n,s,o)),setTimeout(r.fun,1e3)}},r.state={editmode:!1,name:e.auth.user.name,password:"",confirmpassword:"",selectedFile:null},r}return Object(i.a)(n,[{key:"componentWillUnmount",value:function(){this.props.dispatch(oe())}},{key:"render",value:function(){var e=this,t=this.state.editmode,n=this.props.auth,r=n.user,s=n.error,o=(n.profile_changed,te.SERVER_URL()+r.avatar);return console.log("IMAGE",o),console.log(t),Object(pe.jsxs)("div",{className:"profile-container",children:[Object(pe.jsx)("div",{className:"user-icon",children:Object(pe.jsx)("img",{src:void 0!==r.avatar?o:"https://cdn-icons-png.flaticon.com/512/2922/2922506.png"})}),Object(pe.jsxs)("div",{className:"setting-container",children:[s&&Object(pe.jsx)("div",{className:"alert-dialog",children:s}),0==s&&1==t&&Object(pe.jsx)("div",{className:"success-dialog",children:"Successfully Updated"}),Object(pe.jsxs)("div",{className:"show-field2",children:[Object(pe.jsx)("input",{className:"show-field-input2",type:"file",onChange:this.handleFile}),Object(pe.jsx)("button",{className:"upload-btn",onClick:this.handleUpload,children:"Upload"})]}),Object(pe.jsxs)("div",{className:"show-field",children:[Object(pe.jsx)("div",{className:"show-field-heading",children:"Email"}),Object(pe.jsx)("div",{className:"show-field-input",children:r.email})]}),0==t&&Object(pe.jsxs)("div",{className:"show-field",children:[Object(pe.jsx)("div",{className:"show-field-heading",children:"Name"}),Object(pe.jsx)("div",{className:"show-field-input",children:r.name})]}),t&&Object(pe.jsxs)("div",{className:"show-input",children:[Object(pe.jsx)("div",{className:"show-field-heading",children:"Name"}),Object(pe.jsx)("input",{value:this.state.name,onChange:function(t){e.handleChange(t.target.value,"name")}})]}),t&&Object(pe.jsxs)("div",{className:"show-input",children:[Object(pe.jsx)("div",{className:"show-field-heading",children:"New Password"}),Object(pe.jsx)("input",{onChange:function(t){e.handleChange(t.target.value,"password")}})]}),t&&Object(pe.jsxs)("div",{className:"show-input",children:[Object(pe.jsx)("div",{className:"show-field-heading",children:"Confirm Password"}),Object(pe.jsx)("input",{onChange:function(t){e.handleChange(t.target.value,"confirmpassword")}})]}),Object(pe.jsxs)("div",{className:"Button-container",children:[0==t&&Object(pe.jsx)("button",{className:"setting-btn",onClick:this.handleEdit,children:"Edit Profile"}),t&&Object(pe.jsx)("button",{className:"setting-btn",onClick:this.handleSave,children:"Save Profile"}),t&&Object(pe.jsx)("button",{className:"setting-btn",onClick:this.handleBack,children:"Go Back"})]})]})]})}}]),n}(r.Component);var et=Object(h.b)((function(e){return{auth:e.auth}}))($e);function tt(e){return function(t){var n=te.fetchProfile(e);t({type:_});var r=localStorage.getItem("token");fetch(n,{method:"GET",headers:{"Content-type":"application/json; charset=UTF-8",Authorization:"Bearer ".concat(r)}}).then((function(e){return"401"==e.status&&t(se()),e.json()})).then((function(e){console.log(e),e.success?setTimeout((function(){var n;t((n=e.data.user,{type:E,user:n}))}),500):setTimeout((function(){var n;t((n=e.error,{type:C,error:n}))}),500)})).catch((function(e){return console.log("error",e)}))}}var nt=function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(e){var r;return Object(a.a)(this,n),(r=t.call(this,e)).handleAddfriend=function(){var e=r.props.match.params.userId;r.props.dispatch(Fe(e))},r.handleRemoveFriend=function(){var e=r.props.match.params.userId;r.props.dispatch(we(e))},r.checkIsUserFriend=function(){var e=r.props.match.params.userId,t=r.props.auth.user,n=r.props.friends.friendships,s=[];return n.map((function(e){var n=e.from_user._id;n==t._id&&(n=e.to_user._id),s.push(n)})),-1!==s.indexOf(e)},r}return Object(i.a)(n,[{key:"componentDidMount",value:function(){this.props.match.params.userId&&this.props.dispatch(tt(this.props.match.params.userId))}},{key:"componentDidUpdate",value:function(e){var t=e.match.params,n=this.props.match.params;n&&t&&n.userId!==t.userId&&this.props.dispatch(tt(n.userId))}},{key:"componentWillUnmount",value:function(){this.props.dispatch(Le())}},{key:"render",value:function(){var e=this.checkIsUserFriend(),t=this.props.profile.user,n=this.props.auth.user,r=this.props.profile,s=r.error,o=r.inProgress,c=te.SERVER_URL()+t.avatar;return console.log("PROFILE",t),n.email==t.email?Object(pe.jsx)(ue.a,{to:"/settings"}):o?Object(pe.jsx)("div",{className:"ploader",children:Object(pe.jsx)(ge.BoxesLoader,{boxColor:"#6366F1",style:{marginBottom:"20px"},desktopSize:"128px",mobileSize:"80px"})}):s?Object(pe.jsx)("h1",{children:s}):Object(pe.jsxs)("div",{className:"profile-container",children:[Object(pe.jsx)("div",{className:"user-icon",children:Object(pe.jsx)("img",{src:void 0!==t.avatar?c:"https://cdn-icons-png.flaticon.com/512/2922/2922506.png"})}),Object(pe.jsxs)("div",{className:"setting-container",children:[this.props.friends.error&&Object(pe.jsx)("div",{className:"alert-dialog",children:this.props.friends.error}),0==this.props.friends.error&&Object(pe.jsxs)("div",{className:"success-dialog",children:["Successfully ",e?"added":"removed"," friend"]}),Object(pe.jsxs)("div",{className:"show-field",children:[Object(pe.jsx)("div",{className:"show-field-heading",children:"Email"}),Object(pe.jsx)("div",{className:"show-field-input",children:t.email})]}),Object(pe.jsxs)("div",{className:"show-field",children:[Object(pe.jsx)("div",{className:"show-field-heading",children:"Name"}),Object(pe.jsx)("div",{className:"show-field-input",children:t.name})]}),Object(pe.jsx)("div",{className:"Button-container",children:0==e?Object(pe.jsx)("button",{className:"add-friend-btn",disabled:this.props.friends.inProgress,onClick:this.handleAddfriend,children:this.props.friends.inProgress?"Adding Friend":"Add Friend"}):Object(pe.jsx)("button",{className:"add-friend-btn",disabled:this.props.friends.inProgress,onClick:this.handleRemoveFriend,children:this.props.friends.inProgress?"Removing Friend":"Remove Friend"})})]})]})}}]),n}(r.Component);var rt=Object(h.b)((function(e){return{auth:e.auth,profile:e.profile,friends:e.friends}}))(nt),st=n(42),ot=n.n(st),ct=n(47),at=n(16),it=n(53),ut=function(e){return function(t){var n=te.get_conversation(e),r=localStorage.getItem("token");t({type:Q}),fetch(n,{method:"GET",headers:{"Content-type":"application/json; charset=UTF-8",Authorization:"Bearer ".concat(r)}}).then((function(e){return"401"==e.status&&t(se()),e.json()})).then((function(e){var n,r;console.log("Data",e),e.success?t((r=e.data.conversation,{type:K,conversation:r})):t((n=e.error,{type:X,error:n}))})).catch((function(e){return console.log("error",e)}))}};var lt=function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(e){return Object(a.a)(this,n),t.call(this,e)}return Object(i.a)(n,[{key:"render",value:function(){var e=this.props.msg,t=this.props.userId;return Object(pe.jsx)("div",{className:t==e.user._id?"self-msg-outer":"other-msg-outer",children:Object(pe.jsxs)("div",{className:t==e.user._id?"self":"other",children:[Object(pe.jsx)("div",{className:"msgsender",children:e.user.name}),Object(pe.jsx)("div",{className:"msg",children:e.content})]})})}}]),n}(r.Component),dt=function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(){var e;return Object(a.a)(this,n),(e=t.call(this)).handleSend=Object(ct.a)(ot.a.mark((function t(){var n,r,s;return ot.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=e.props.match.params.fid,console.log("CONVERSATION",n),0!==e.state.message.length&&((r={}).content=e.state.message,s=e.props.auth.user,r.user={name:s.name,_id:s._id,email:s.email},e.socket.emit("send-message",r,n));case 3:case"end":return t.stop()}}),t)}))),e.handleChange=function(t){e.setState({message:t.target.value})},e.setupconnections=function(){var t=Object(at.a)(e),n=e.socket;e.socket.on("connect",(function(){console.log("CONNECTION ESTABILISHED");var e=t.props.match.params.fid;n.emit("join_room",e)})),e.socket.on("receive-message",(function(e){console.log("RECEIVED_DATA",e),t.props.dispatch(function(e){return{type:Y,message:e}}(e))}))},e.state={message:""},e.socket=it.a.connect("https://socket-server-101.herokuapp.com"),e}return Object(i.a)(n,[{key:"componentDidMount",value:function(){var e=this.props.match.params.fid;this.props.dispatch(ut(e)),this.setupconnections()}},{key:"componentWillUnmount",value:function(){this.socket.disconnect(),this.socket.off()}},{key:"render",value:function(){var e=this.props.auth.user;if(!e)return Object(pe.jsx)(ue.a,{to:"/login"});console.log("MESSAGE",this.props.conversation.conversation.messages);var t=this.props.conversation.conversation.messages;return t||(t=[]),Object(pe.jsxs)("div",{className:"mainright",children:[Object(pe.jsx)("div",{className:"msg-container",children:t.map((function(t,n){return Object(pe.jsx)(lt,{Key:n,msg:t,userId:e._id})}))}),Object(pe.jsxs)("div",{className:"msg-input-container",children:[Object(pe.jsx)("input",{className:"msginput",onChange:this.handleChange}),Object(pe.jsx)("button",{onClick:this.handleSend,className:"sendbtn",children:"Send"})]})]})}}]),n}(r.Component);var ht=Object(h.b)((function(e){return{auth:e.auth,conversation:e.conversation}}))(dt),pt=function(e){var t=e.isLoggedIn,n=e.path,r=e.component;return Object(pe.jsx)(ue.b,{path:n,render:function(e){return console.log("Props",e),1==t?Object(pe.jsx)(r,Object(d.a)({},e)):Object(pe.jsx)(ue.a,{to:{pathname:"/login",state:{from:e.location}}})}})},jt=function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(){return Object(a.a)(this,n),t.apply(this,arguments)}return Object(i.a)(n,[{key:"componentDidMount",value:function(){var e=localStorage.getItem("token");if(e){var t=Object(Xe.a)(e);this.props.dispatch(function(e){return{type:x,user:e}}(t))}}},{key:"render",value:function(){var e=this.props,t=(e.posts,e.auth);return console.log("loggedin",t.isLoggedIn),Object(pe.jsx)(le.a,{children:Object(pe.jsxs)("div",{children:[Object(pe.jsx)(Ie,{}),Object(pe.jsxs)(ue.d,{children:[Object(pe.jsx)(ue.b,{exact:!0,path:"/",render:function(e){return Object(pe.jsx)(Me,Object(d.a)({},e))}}),Object(pe.jsx)(ue.b,{path:"/login",exact:!0,component:We}),Object(pe.jsx)(ue.b,{path:"/Register",exact:!0,component:Qe}),Object(pe.jsx)(pt,{path:"/settings",exact:!0,component:et,isLoggedIn:t.isLoggedIn}),Object(pe.jsx)(pt,{path:"/user/:userId",exact:!0,component:rt,isLoggedIn:t.isLoggedIn}),Object(pe.jsx)(pt,{path:"/chat/:fid",exact:!0,component:ht,isLoggedIn:t.isLoggedIn}),Object(pe.jsx)(ue.b,{component:Ve})]}),Object(pe.jsx)(Ge,{})]})})}}]),n}(r.Component);var mt=Object(h.b)((function(e){return{posts:e.posts,auth:e.auth}}))(jt),ft=n(32),bt=n(51),vt={user:{},error:null,isLoggedIn:!1,inProgress:!1,profile:""};var Ot={inProgress:!1,user:{},error:null};var gt={friendships:[],inProgress:!1,error:null};var xt={results:[]};var St={conversation:{},inProgress:!1,error:null};var Nt=Object(ft.b)({posts:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Z,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case j:return Object(d.a)(Object(d.a)({},e),{},{posts:t.posts,next:t.next,prev:t.prev,error:null});case G:return{posts:[t.post].concat(Object(p.a)(e.posts)),error:!1};case z:return Object(d.a)(Object(d.a)({},e),{},{error:t.error});case M:var n=e.posts.map((function(e){return e._id==t.post_id?Object(d.a)(Object(d.a)({},e),{},{comment:[t.comment].concat(Object(p.a)(e.comment))}):e}));return Object(d.a)(Object(d.a)({},e),{},{posts:n,error:null});case V:return{error:t.error};case H:if("Post"==t.likeabletype){var r=e.posts.map((function(e){if(e._id==t.id){if(t.deleted){var n=e.likes.filter((function(e){return e._id!=t.like._id}));return Object(d.a)(Object(d.a)({},e),{},{likes:n})}var r=e.likes;return r.push(t.like),Object(d.a)(Object(d.a)({},e),{},{likes:r})}return e}));return Object(d.a)(Object(d.a)({},e),{},{posts:r})}var s=e.posts.map((function(e){var n=e.comment.map((function(e){if(e._id==t.id){if(t.deleted){var n=e.likes.filter((function(e){return e._id!=t.like._id}));return Object(d.a)(Object(d.a)({},e),{},{likes:n})}var r=e.likes;return r.push(t.like),Object(d.a)(Object(d.a)({},e),{},{likes:r})}return e}));return Object(d.a)(Object(d.a)({},e),{},{comment:n})}));return Object(d.a)(Object(d.a)({},e),{},{posts:s});default:return e}},auth:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:vt,t=arguments.length>1?arguments[1]:void 0;switch(console.log("action-----\x3e",t),t.type){case m:case v:return Object(d.a)(Object(d.a)({},e),{},{inProgress:!0});case f:case O:return Object(d.a)(Object(d.a)({},e),{},{isLoggedIn:!0,inProgress:!1,error:null,user:t.user});case b:case g:case k:return Object(d.a)(Object(d.a)({},e),{},{inProgress:!1,error:t.error});case x:return Object(d.a)(Object(d.a)({},e),{},{error:null,user:t.user,isLoggedIn:!0});case S:return{user:{},error:null,isLoggedIn:!1,inProgress:!1};case N:return Object(d.a)(Object(d.a)({},e),{},{error:null,editmode:!1});case y:return Object(d.a)(Object(d.a)({},e),{},{isLoggedIn:!0,inProgress:!1,error:!1,user:t.user,editmode:!1});default:return e}},profile:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ot,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case _:return Object(d.a)(Object(d.a)({},e),{},{inProgress:!0,error:null});case E:return Object(d.a)(Object(d.a)({},e),{},{inProgress:!1,user:t.user,error:null});case C:return Object(d.a)(Object(d.a)({},e),{},{inProgress:!1,error:t.error});case I:return{inProgress:!1,user:{},error:null};default:return e}},friends:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:gt,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case P:return Object(d.a)(Object(d.a)({},e),{},{error:t.error,inProgress:!1});case F:return Object(d.a)(Object(d.a)({},e),{},{error:null,inProgress:!0});case T:return Object(d.a)(Object(d.a)({},e),{},{error:null,inProgress:!1,friendships:t.friendships});case w:return Object(d.a)(Object(d.a)({},e),{},{error:!1,inProgress:!1,friendships:[].concat(Object(p.a)(e.friendships),[t.friendship])});case R:case D:return Object(d.a)(Object(d.a)({},e),{},{inProgress:!0,error:null});case L:case U:return Object(d.a)(Object(d.a)({},e),{},{inProgress:!1,error:t.error});case B:return Object(d.a)(Object(d.a)({},e),{},{inProgress:!1,error:null});case A:return Object(d.a)(Object(d.a)({},e),{},{error:!1,inProgress:!1,friendships:e.friendships.filter((function(e){return e._id!==t.id}))});default:return e}},search:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:xt,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case J:return Object(d.a)(Object(d.a)({},e),{},{results:t.results});case q:return{results:[]};default:return e}},conversation:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:St,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case X:return Object(d.a)(Object(d.a)({},e),{},{error:t.error,inProgress:!1});case Q:return Object(d.a)(Object(d.a)({},e),{},{error:null,inProgress:!0});case K:return Object(d.a)(Object(d.a)({},e),{},{error:null,inProgress:!1,conversation:t.conversation});case Y:var n=e.conversation;return n.messages.push(t.message),Object(d.a)(Object(d.a)({},e),{},{conversation:n});default:return e}}}),yt=n(52),kt=n.n(yt);var Et=Object(ft.c)(Nt,Object(ft.a)(kt.a,bt.a));console.log(Et.getState()),c.a.render(Object(pe.jsx)(h.a,{store:Et,children:Object(pe.jsx)(s.a.StrictMode,{children:Object(pe.jsx)(mt,{})})}),document.getElementById("root"))}},[[79,1,2]]]);
//# sourceMappingURL=main.e222b967.chunk.js.map